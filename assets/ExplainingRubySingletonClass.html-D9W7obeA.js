import{_ as n,c as a,a as e,o as l}from"./app-wnH-bxgu.js";const i={};function t(p,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="️-explaining-ruby-s-singleton-class-eigenclass-to-confused-beginners" tabindex="-1"><a class="header-anchor" href="#️-explaining-ruby-s-singleton-class-eigenclass-to-confused-beginners"><span>⁉️ Explaining Ruby&#39;s Singleton Class (Eigenclass) to confused beginners</span></a></h1><p>I got really confused when I started to look up exactly what was the Eigenclass. This confusion was not because of any complexity, but rather because of bad bits of explanations there and there, and no articles to describe the big picture.</p><p>So my goal here is to help with that by explaining exactly what is Ruby&#39;s Eigenclass and why it&#39;s called &quot;The Singleton Class&quot;.</p><p>To understand the Eigenclass, you just need to know the very basic concepts of Class and Instances. A reminder:</p><ul><li>Classes are what we use to define our objects</li><li>Instances of classes are the objects created by our classes</li></ul><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">class</span> <span class="token class-name">MyClass</span></span>
<span class="line">  <span class="token comment"># Body of class</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">MyClass <span class="token comment"># =&gt; class</span></span>
<span class="line"><span class="token class-name">MyClass</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment"># =&gt; Instance of MyClass</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="what-s-the-eigenclass" tabindex="-1"><a class="header-anchor" href="#what-s-the-eigenclass"><span>What&#39;s the Eigenclass ?</span></a></h2><p>Here&#39;s the bit of information I had the most trouble to find: the Eigenclass is called the Singleton class because <em>it is a Class that follows the Singleton pattern</em>.</p><h2 id="the-singleton-pattern" tabindex="-1"><a class="header-anchor" href="#the-singleton-pattern"><span>The Singleton pattern</span></a></h2><p>The Singleton pattern is simply an object-oriented programming pattern where you make sure to only have 1 and only 1 instance of some class.</p><p>Ruby implements the Singleton pattern with a module: just write <code>Include Singleton</code> in your class definition and you&#39;re good to go.</p><p>This module basically hides the <code>:new</code> method. <code>MySingletonObject.new</code> will always ERROR. Instead, it will give you an <code>instance</code> method that will always return the same unique instance of your class.</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">&#39;singleton&#39;</span></span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">NotSingleton</span></span>
<span class="line">  <span class="token comment"># &#39;initialize&#39; is called everytime an instance is created</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;This will be printed many times&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">MySingleton</span></span>
<span class="line">  <span class="token keyword">include</span> Singleton</span>
<span class="line"></span>
<span class="line">  <span class="token comment"># &#39;initialize&#39; is called everytime an instance is created</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;This will be printed once&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">NotSingleton</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment"># =&gt; &#39;This will be printed many times&#39;</span></span>
<span class="line"><span class="token class-name">NotSingleton</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment"># =&gt; &#39;This will be printed many times&#39;</span></span>
<span class="line"><span class="token class-name">NotSingleton</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment"># =&gt; &#39;This will be printed many times&#39;</span></span>
<span class="line"></span>
<span class="line">MySingleton<span class="token punctuation">.</span>instance <span class="token comment"># =&gt; &#39;This will be printed once&#39;</span></span>
<span class="line">MySingleton<span class="token punctuation">.</span>instance <span class="token comment"># Nothing is printed</span></span>
<span class="line">MySingleton<span class="token punctuation">.</span>instance <span class="token comment"># Nothing is printed</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>This is useful if you ever want to restrict a class so it never creates more than one instance of itself.</p><h2 id="the-eigenclass" tabindex="-1"><a class="header-anchor" href="#the-eigenclass"><span>The Eigenclass</span></a></h2><p>When you create an instance of a class, Ruby creates a hidden class, basically a copy of the original class, but that is <em>owned exclusively by this instance</em>. This is the Eigenclass. If you modify the Eigenclass of your first instance, it won&#39;t change anything for another instance.</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token comment"># This class is NOT a singleton</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ExampleObject</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Hello&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">object1 <span class="token operator">=</span> <span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span></span>
<span class="line">object2 <span class="token operator">=</span> <span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span></span>
<span class="line"></span>
<span class="line">object1<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line">object2<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">def</span> <span class="token method-definition"><span class="token class-name">object2</span><span class="token punctuation">.</span><span class="token function">print_hello</span></span></span>
<span class="line">  puts <span class="token string-literal"><span class="token string">&#39;Bonjour&#39;</span></span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">object1<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line">object2<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Bonjour&#39;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>There we go ! <code>object2</code> is not defined in the scope of the class ExampleObject, it is defined by a copy of its class that it carries around. So by redefining a method in <code>object2</code>, we &quot;open the Eigenclass&quot; and modify properties just for this object.</p><p>Since the Eigenclass can exist only in one instance, it is sometimes called the Singleton class, althought ExampleObject is not a Singleton at all. Only the Eigenclasses of its instances are Singletons, because they each are one and unique.</p><h2 id="the-class-self-notation" tabindex="-1"><a class="header-anchor" href="#the-class-self-notation"><span>The class &lt;&lt; self notation</span></a></h2><p>The previous example can be rewritten this way:</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">class</span> <span class="token class-name">ExampleObject</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Hello&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">object1 <span class="token operator">=</span> <span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span></span>
<span class="line">object2 <span class="token operator">=</span> <span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token operator">&lt;&lt;</span> object2</span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Aloha&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">object1<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line">object2<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Aloha&#39;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, the <code>class &lt;&lt; object2</code> syntax is used to access the Eigenclass of <code>object2</code>.</p><p>Now for the neat trick: you might know that, in Ruby, classes are objects too. In Ruby, everything is an object!</p><p>And the <code>Class</code> of any class is always, well, <code>Class</code>. I love this about Ruby: it seems to not make any sense, but it actually does, in its own way.</p><p>You can try it yourself:</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token comment"># We can create ExampleObject like this :</span></span>
<span class="line"><span class="token keyword">class</span> <span class="token class-name">ExampleObject</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Or like this :</span></span>
<span class="line">ExampleObject <span class="token operator">=</span> <span class="token class-name">Class</span><span class="token punctuation">.</span><span class="token keyword">new</span></span>
<span class="line"></span>
<span class="line"><span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment"># =&gt; ExampleObject</span></span>
<span class="line">ExampleObject<span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment"># =&gt; Class</span></span>
<span class="line"><span class="token builtin">Class</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment"># =&gt; Class</span></span>
<span class="line">ExampleObject<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token keyword">class</span> <span class="token comment"># =&gt; Class</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So, we just saw that the class <code>ExampleObject</code> is an object too, and more precisely, it is an instance of the class <code>Class</code>. This must mean that it also has its own Eigenclass!</p><p>And if the Eigenclass of an instance of your class &#39;ExampleObject&#39; is somewhat of a copy of the class &#39;ExampleObject&#39;, then the Eigenclass of the class &#39;ExampleObject&#39; must be somewhat of a copy of the class &#39;Class&#39;.</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token comment"># Instance of class ExampleObject</span></span>
<span class="line"><span class="token class-name">ExampleObject</span><span class="token punctuation">.</span><span class="token keyword">new</span> <span class="token comment"># =&gt; Eigenclass : a copy of ExampleObject</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># Instance of class Class</span></span>
<span class="line">ExampleObject <span class="token comment"># =&gt; Eigenclass : a copy of Class</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Now, let&#39;s say we want to access the Eigenclass of the ExampleObject class.</p><p>We can do it this way:</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">class</span> <span class="token class-name">ExampleObject</span></span>
<span class="line">  <span class="token comment"># Either inside the definition of the class</span></span>
<span class="line">  <span class="token keyword">class</span> <span class="token operator">&lt;&lt;</span> <span class="token keyword">self</span></span>
<span class="line">    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_hello</span></span></span>
<span class="line">      puts <span class="token string-literal"><span class="token string">&#39;Hello&#39;</span></span></span>
<span class="line">    <span class="token keyword">end</span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">ExampleObject<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># or outside</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">class</span> <span class="token operator">&lt;&lt;</span> ExampleObject</span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Sayonara&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">ExampleObject<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Sayonara&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you see here, we don&#39;t call the method on an instance of the class (ExampleObject.new) but rather on the class itself (ExampleObject). It&#39;s okay though, because ExampleObject is itself an instance of <code>Class</code>.</p><h2 id="if-you-re-using-class-methods-you-re-really-using-the-eigenclass" tabindex="-1"><a class="header-anchor" href="#if-you-re-using-class-methods-you-re-really-using-the-eigenclass"><span>If you&#39;re using Class methods, you&#39;re really using the Eigenclass</span></a></h2><p>If you do some Rails, you&#39;ll often have in your models:</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">class</span> <span class="token class-name">MyModel</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Hello&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">MyModel<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, defining a method on the <code>self</code> object inside a class definition is exactly the same thing as opening the Eigenclass with <code>class &lt;&lt; self</code>.</p><p><code>self.print_hello</code> is also called a Class method, to differenciate with an Instance method. See the following:</p><div class="language-ruby line-numbers-mode" data-highlighter="prismjs" data-ext="rb"><pre><code class="language-ruby"><span class="line"><span class="token keyword">class</span> <span class="token class-name">MyModel</span></span>
<span class="line">  <span class="token comment"># Class Method</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">print_hello</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Hello&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment"># Instance Method</span></span>
<span class="line">  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">print_bonjour</span></span></span>
<span class="line">    puts <span class="token string-literal"><span class="token string">&#39;Bonjour&#39;</span></span></span>
<span class="line">  <span class="token keyword">end</span></span>
<span class="line"><span class="token keyword">end</span></span>
<span class="line"></span>
<span class="line">MyModel<span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; &#39;Hello&#39;</span></span>
<span class="line"><span class="token class-name">MyModel</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>print_hello <span class="token comment"># =&gt; ERROR</span></span>
<span class="line">MyModel<span class="token punctuation">.</span>print_bonjour <span class="token comment"># =&gt; ERROR</span></span>
<span class="line"><span class="token class-name">MyModel</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">.</span>print_bonjour <span class="token comment"># =&gt; &#39;Bonjour&#39;</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>So as you see, the <em>Class method</em> of your class is actually just an <em>Instance method</em> of the Eigenclass of your class.</p><p>Don&#39;t hesitate and repeat that last sentence to your company&#39;s interns: they&#39;ll think you&#39;re a Ruby genius!</p>`,42)]))}const o=n(i,[["render",t]]),d=JSON.parse(`{"path":"/lessons/ExplainingRubySingletonClass.html","title":"⁉️ Explaining Ruby's Singleton Class (Eigenclass) to confused beginners","lang":"en-US","frontmatter":{"title":"⁉️ Explaining Ruby's Singleton Class (Eigenclass) to confused beginners","description":"Much Ruby, Eigenvery, so singleton.","footer":"CC-BY-4.0 Licensed | Copyright © 2018-present by Samuel Faure <3"},"git":{"updatedTime":1761891624000,"contributors":[{"name":"Samuelfaure","username":"Samuelfaure","email":"samuel.faure.dev@gmail.com","commits":1,"url":"https://github.com/Samuelfaure"}],"changelog":[{"hash":"3e80d8aaf6dc1a00d2b2d49762569040eac3e944","time":1761891624000,"email":"samuel.faure.dev@gmail.com","author":"Samuelfaure","message":"New article: AI dev trap"}]},"filePathRelative":"lessons/ExplainingRubySingletonClass.md"}`);export{o as comp,d as data};
