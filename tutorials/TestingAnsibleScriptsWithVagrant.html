<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.24" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme='dark'] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background-color: var(--vp-c-bg);
      }
    </style>
    <script>
      const useChoice = localStorage.getItem('vuepress-color-scheme')
      const systemStatus =
        'matchMedia' in window
          ? window.matchMedia('(prefers-color-scheme: dark)').matches
          : false

      if (useChoice === 'light') {
        document.documentElement.dataset.theme = 'light'
      } else if (useChoice === 'dark' || systemStatus) {
        document.documentElement.dataset.theme = 'dark'
      }
    </script>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" size="180x180"><link rel="icon" type="image.png" href="/favicon-32x32.png" size="32x32"><link rel="icon" type="image.png" href="/favicon-16x16.png" size="16x16"><link rel="manifest" href="/site.webmanifest"><link rel="stylesheet" href="/styles/index.css"><meta property="og:type" content="website"><meta property="og:url" content="https://suchdevblog.com/"><meta property="og:title" content="Such Dev Blog"><meta property="og:description" content="Much code, very webdev. A blog by Samuel Faure about web development, Ruby on Rails, Node.js, and more."><meta property="og:image" content="https://suchdevblog.com/images/devpic.webp"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:url" content="https://suchdevblog.com/"><meta name="twitter:title" content="Such Dev Blog"><meta name="twitter:description" content="Much code, very webdev. A blog by Samuel Faure about web development, Ruby on Rails, Node.js, and more."><meta name="twitter:image" content="https://suchdevblog.com/images/devpic.webp"><meta name="author" content="Samuel Faure"><meta name="keywords" content="web development, Ruby on Rails, Node.js, fullstack, developer, blog, tutorials, programming"><meta name="msapplication-TileColor" content="#da532c"><meta name="theme-color" content="#ffffff"><script data-goatcounter="https://suchdevblog.goatcounter.com/count" async src="https://gc.zgo.at/count.js"></script><title>💽 Testing Ansible scripts with Vagrant | Such Dev Blog</title><meta name="description" content="Very ansible, much deployment">
    <link rel="preload" href="/assets/style-Pd9_wNba.css" as="style"><link rel="stylesheet" href="/assets/style-Pd9_wNba.css">
    <link rel="modulepreload" href="/assets/app-wnH-bxgu.js"><link rel="modulepreload" href="/assets/TestingAnsibleScriptsWithVagrant.html-Dds0nuf2.js">
    <link rel="prefetch" href="/assets/Portfolio.html-C6Rmi74G.js" as="script"><link rel="prefetch" href="/assets/index.html-CXnzzwTA.js" as="script"><link rel="prefetch" href="/assets/WhoAmI.html-MdILxMwe.js" as="script"><link rel="prefetch" href="/assets/lessons.html-LG327zce.js" as="script"><link rel="prefetch" href="/assets/opinions.html-C9VKvfnJ.js" as="script"><link rel="prefetch" href="/assets/resources.html-B_-loIDW.js" as="script"><link rel="prefetch" href="/assets/tutorials.html-C_r2JmYH.js" as="script"><link rel="prefetch" href="/assets/AIDevTrap.html-C-HQhiq0.js" as="script"><link rel="prefetch" href="/assets/AtomicGitCommits.html-VpQdPwXh.js" as="script"><link rel="prefetch" href="/assets/ExplainingRubySingletonClass.html-D9W7obeA.js" as="script"><link rel="prefetch" href="/assets/HowToLearnGit.html-CSR2ga0X.js" as="script"><link rel="prefetch" href="/assets/HowToNotUseYourBrain.html-rOPdEpoH.js" as="script"><link rel="prefetch" href="/assets/HowToStartCSS.html-DPznZxXK.js" as="script"><link rel="prefetch" href="/assets/ProductivityAndWellBeing.html-1n5NZ-Fo.js" as="script"><link rel="prefetch" href="/assets/TheHangoverTest.html-Di7Nh5Eg.js" as="script"><link rel="prefetch" href="/assets/MarieKondo.html-ObeJE8Lr.js" as="script"><link rel="prefetch" href="/assets/NetworkingIsNotWhatYouThink.html-BuCIMkBr.js" as="script"><link rel="prefetch" href="/assets/TechnicalDebtKitchen.html-CMQ1FZTc.js" as="script"><link rel="prefetch" href="/assets/WhatOpenSourceIs.html-b5sTn53O.js" as="script"><link rel="prefetch" href="/assets/WhyDiversityIsGreat.html-C7okgH5F.js" as="script"><link rel="prefetch" href="/assets/WhyOurWorkCultureSucks.html-BEzeygBR.js" as="script"><link rel="prefetch" href="/assets/BeginnersResources.html-CywoCBRr.js" as="script"><link rel="prefetch" href="/assets/DesignResources.html-BQxiW-1K.js" as="script"><link rel="prefetch" href="/assets/IntermediateResources.html-DE6zwc1Y.js" as="script"><link rel="prefetch" href="/assets/LLMResources.html-D4PnIrK1.js" as="script"><link rel="prefetch" href="/assets/SeniorResources.html-BJs8yhLX.js" as="script"><link rel="prefetch" href="/assets/BuildYourOwnSystem.html-Cn6Aln59.js" as="script"><link rel="prefetch" href="/assets/DebuggingSolrSunspot.html-Dec1LqM6.js" as="script"><link rel="prefetch" href="/assets/FilterAnythingInRails.html-DPeKoRrM.js" as="script"><link rel="prefetch" href="/assets/HowToUseSolrWithRails.html-DE77dpxD.js" as="script"><link rel="prefetch" href="/assets/TestAllYourRoutesInRails.html-CLTI49vi.js" as="script"><link rel="prefetch" href="/assets/UploadFilesFromVueToRails.html--i1uP2el.js" as="script"><link rel="prefetch" href="/assets/404.html-B9a58S7U.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><div class="vp-theme-container external-link-icon" vp-container><!--[--><header class="vp-navbar" vp-navbar><div class="vp-toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a class="route-link" href="/"><!----><span class="vp-site-name" aria-hidden="true">Such Dev Blog</span></a></span><div class="vp-navbar-items-wrapper" style=""><!--[--><!--]--><nav class="vp-navbar-items vp-hide-mobile" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/WhoAmI.html" aria-label="Who am I ?"><!--[--><!--[--><!--]--><!--]-->Who am I ?<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Portfolio.html" aria-label="Portfolio"><!--[--><!--[--><!--]--><!--]-->Portfolio<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resources.html" aria-label="Resources"><!--[--><!--[--><!--]--><!--]-->Resources<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/lessons.html" aria-label="Lessons"><!--[--><!--[--><!--]--><!--]-->Lessons<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/opinions.html" aria-label="Opinions"><!--[--><!--[--><!--]--><!--]-->Opinions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tutorials.html" aria-label="Tutorials"><!--[--><!--[--><!--]--><!--]-->Tutorials<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button type="button" class="vp-toggle-color-mode-button" title="toggle color mode"><svg class="light-icon" viewbox="0 0 32 32" style="display:none;"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg class="dark-icon" viewbox="0 0 32 32" style=""><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="vp-sidebar-mask"></div><!--[--><aside class="vp-sidebar" vp-sidebar><nav class="vp-navbar-items" aria-label="site navigation"><!--[--><div class="vp-navbar-item"><a class="route-link auto-link" href="/WhoAmI.html" aria-label="Who am I ?"><!--[--><!--[--><!--]--><!--]-->Who am I ?<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/Portfolio.html" aria-label="Portfolio"><!--[--><!--[--><!--]--><!--]-->Portfolio<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/resources.html" aria-label="Resources"><!--[--><!--[--><!--]--><!--]-->Resources<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/lessons.html" aria-label="Lessons"><!--[--><!--[--><!--]--><!--]-->Lessons<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/opinions.html" aria-label="Opinions"><!--[--><!--[--><!--]--><!--]-->Opinions<!--[--><!--[--><!--]--><!--]--></a></div><div class="vp-navbar-item"><a class="route-link auto-link" href="/tutorials.html" aria-label="Tutorials"><!--[--><!--[--><!--]--><!--]-->Tutorials<!--[--><!--[--><!--]--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="vp-sidebar-items"><!--[--><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/WhoAmI.html" aria-label="Who am I ?"><!--[--><!--[--><!--]--><!--]-->Who am I ?<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item vp-sidebar-heading" href="/Portfolio.html" aria-label="Portfolio"><!--[--><!--[--><!--]--><!--]-->Portfolio<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Resources <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/resources/BeginnersResources.html" aria-label="👶 Resources for the Beginner WebDev"><!--[--><!--[--><!--]--><!--]-->👶 Resources for the Beginner WebDev<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/resources/IntermediateResources.html" aria-label="👩 Resources for the Intermediate WebDev"><!--[--><!--[--><!--]--><!--]-->👩 Resources for the Intermediate WebDev<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/resources/SeniorResources.html" aria-label="👴 Resources for the Senior WebDev"><!--[--><!--[--><!--]--><!--]-->👴 Resources for the Senior WebDev<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/resources/DesignResources.html" aria-label="🧑‍🎨 Design resources for WebDevs"><!--[--><!--[--><!--]--><!--]-->🧑‍🎨 Design resources for WebDevs<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/resources/LLMResources.html" aria-label="🤖 LLM / AI Resources"><!--[--><!--[--><!--]--><!--]-->🤖 LLM / AI Resources<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Lessons <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/AIDevTrap.html" aria-label="🤖 The AI development trap that wastes your time"><!--[--><!--[--><!--]--><!--]-->🤖 The AI development trap that wastes your time<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/TheHangoverTest.html" aria-label="🍻 Does your Pull Request pass the Hangover test?"><!--[--><!--[--><!--]--><!--]-->🍻 Does your Pull Request pass the Hangover test?<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/ProductivityAndWellBeing.html" aria-label="📈 Productivity and Well-being, A summary of what works."><!--[--><!--[--><!--]--><!--]-->📈 Productivity and Well-being, A summary of what works.<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/AtomicGitCommits.html" aria-label="⭐ Dramatically increase your productivity with Atomic Git Commits"><!--[--><!--[--><!--]--><!--]-->⭐ Dramatically increase your productivity with Atomic Git Commits<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/HowToLearnGit.html" aria-label="🧑‍💼 How to Learn Git Slowly"><!--[--><!--[--><!--]--><!--]-->🧑‍💼 How to Learn Git Slowly<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/HowToStartCSS.html" aria-label="😠 How to Start Learning CSS without hating yourself"><!--[--><!--[--><!--]--><!--]-->😠 How to Start Learning CSS without hating yourself<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/HowToNotUseYourBrain.html" aria-label="🧠 How to be a great software engineer without using your brain"><!--[--><!--[--><!--]--><!--]-->🧠 How to be a great software engineer without using your brain<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/lessons/ExplainingRubySingletonClass.html" aria-label="⁉️ Explaining Ruby&#39;s Singleton Class (Eigenclass) to confused beginners"><!--[--><!--[--><!--]--><!--]-->⁉️ Explaining Ruby&#39;s Singleton Class (Eigenclass) to confused beginners<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading">Opinions <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/TechnicalDebtKitchen.html" aria-label="🔪 The Technical Debt explained with a kitchen analogy"><!--[--><!--[--><!--]--><!--]-->🔪 The Technical Debt explained with a kitchen analogy<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/WhyOurWorkCultureSucks.html" aria-label="🪠 Why our work culture sucks"><!--[--><!--[--><!--]--><!--]-->🪠 Why our work culture sucks<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/MarieKondo.html" aria-label="🧹 The Marie Kondo guide for the Clean Developer"><!--[--><!--[--><!--]--><!--]-->🧹 The Marie Kondo guide for the Clean Developer<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/WhatOpenSourceIs.html" aria-label="💡What contributing to Open-source is, and what it isn&#39;t"><!--[--><!--[--><!--]--><!--]-->💡What contributing to Open-source is, and what it isn&#39;t<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/WhyDiversityIsGreat.html" aria-label="💵 Why diversity is important, no, really, actually for real"><!--[--><!--[--><!--]--><!--]-->💵 Why diversity is important, no, really, actually for real<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/opinions/NetworkingIsNotWhatYouThink.html" aria-label="🕸 Networking is easy, fun, and probably not what you think it is."><!--[--><!--[--><!--]--><!--]-->🕸 Networking is easy, fun, and probably not what you think it is.<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><li><p tabindex="0" class="vp-sidebar-item vp-sidebar-heading active">Tutorials <!----></p><ul style="" class="vp-sidebar-children"><!--[--><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/BuildYourOwnSystem.html" aria-label="📐 Build your own system with ArchLinux"><!--[--><!--[--><!--]--><!--]-->📐 Build your own system with ArchLinux<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link route-link-active auto-link vp-sidebar-item active" href="/tutorials/TestingAnsibleScriptsWithVagrant.html" aria-label="💽 Testing Ansible scripts with Vagrant"><!--[--><!--[--><!--]--><!--]-->💽 Testing Ansible scripts with Vagrant<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/UploadFilesFromVueToRails.html" aria-label="💎 Upload Files from Vue.js to Rails with ActiveStorage"><!--[--><!--[--><!--]--><!--]-->💎 Upload Files from Vue.js to Rails with ActiveStorage<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/FilterAnythingInRails.html" aria-label="💎 Filter Anything in a Rails request in 10 lines of code"><!--[--><!--[--><!--]--><!--]-->💎 Filter Anything in a Rails request in 10 lines of code<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/TestAllYourRoutesInRails.html" aria-label="💎 Test all your GET routes in rails with 20 lines of code"><!--[--><!--[--><!--]--><!--]-->💎 Test all your GET routes in rails with 20 lines of code<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/HowToUseSolrWithRails.html" aria-label="💎 How to use Solr / Sunspot with Rails"><!--[--><!--[--><!--]--><!--]-->💎 How to use Solr / Sunspot with Rails<!--[--><!--[--><!--]--><!--]--></a><!----></li><li><a class="route-link auto-link vp-sidebar-item" href="/tutorials/DebuggingSolrSunspot.html" aria-label="💎 Debugging Solr Sunspot like a pro"><!--[--><!--[--><!--]--><!--]-->💎 Debugging Solr Sunspot like a pro<!--[--><!--[--><!--]--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="vp-page"><!--[--><!--]--><div vp-content><!--[--><!--]--><div id="content"><h1 id="💽-testing-ansible-scripts-without-breaking-everything-with-vagrant" tabindex="-1"><a class="header-anchor" href="#💽-testing-ansible-scripts-without-breaking-everything-with-vagrant"><span>💽 Testing ANSIBLE scripts without breaking everything with Vagrant</span></a></h1><p>Testing ANSIBLE scripts for server deployment might be tricky. It is easier to write complex deployment scripts aimed to deploying on clean servers. The correlation is that your script might break a server which is not clean. You might need an empty server to try your script on.</p><p>One solution is to subscribe for a free AWS server. But this solution is limited (time, available space). Another solution is renting a cheap OVH server for 3.50 euros a month, but that might not be ideal either.</p><p>A better solution is provisioning to virtual servers with Vagrant. This solution also has the benefit of being local, so we don&#39;t even need internet for running tests on our ANSIBLE playbooks.</p><p>In this example, we will provision with ANSIBLE a rails app on a virtual server, using Vagrant.</p><h2 id="step-1-install-virtualbox-vagrant" tabindex="-1"><a class="header-anchor" href="#step-1-install-virtualbox-vagrant"><span>Step 1 : Install Virtualbox / Vagrant</span></a></h2><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> virtualbox</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> vagrant</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="step-2-choose-execute-your-box" tabindex="-1"><a class="header-anchor" href="#step-2-choose-execute-your-box"><span>Step 2 : Choose / execute your box</span></a></h2><p>List of boxes available <a href="https://app.vagrantup.com/boxes/search" target="_blank" rel="noopener noreferrer">here</a>.</p><p>We will choose Ubuntu 16.04 (Xenial) :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">vagrant init ubuntu/xenial64</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>You should have a directory vagrant_virtual_drives in your home, containing a log and a Vagrantfile. Go here and execute :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">vagrant up</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Check if everything works correctly by connecting to your virtual machine in SSH :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">vagrant <span class="token function">ssh</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><h2 id="step-3-configuring-vagrantfile-for-being-provisioned-by-ansible-forwarding-rails-port-3000" tabindex="-1"><a class="header-anchor" href="#step-3-configuring-vagrantfile-for-being-provisioned-by-ansible-forwarding-rails-port-3000"><span>Step 3 : configuring Vagrantfile for being provisioned by ANSIBLE / Forwarding Rails port 3000</span></a></h2><p>Add this to your Vagrantfile :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">Vagrant.configure<span class="token punctuation">(</span><span class="token string">&quot;2&quot;</span><span class="token punctuation">)</span> <span class="token keyword">do</span> <span class="token operator">|</span>config<span class="token operator">|</span></span>
<span class="line">  <span class="token comment"># Forward port 3000 to localhost so you can access your rails app in your browser</span></span>
<span class="line">  config.vm.network <span class="token string">&quot;forwarded_port&quot;</span>, guest: <span class="token number">3000</span>, host: <span class="token number">3000</span>, host_ip: <span class="token string">&quot;127.0.0.1&quot;</span></span>
<span class="line">  <span class="token comment"># Allowing your virtual machine to be provisioned by ANSIBLE</span></span>
<span class="line">  config.vm.provision <span class="token string">&quot;ansible&quot;</span> <span class="token keyword">do</span> <span class="token operator">|</span>ansible<span class="token operator">|</span></span>
<span class="line">      ansible.playbook <span class="token operator">=</span> <span class="token string">&quot;playbook.yml&quot;</span></span>
<span class="line">  end</span>
<span class="line">end</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="step-4-provisioning-your-vagrant-virtual-machine" tabindex="-1"><a class="header-anchor" href="#step-4-provisioning-your-vagrant-virtual-machine"><span>Step 4 : Provisioning your Vagrant virtual machine</span></a></h2><p>Add your virtual machine to your ANSIBLE inventory :</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token comment"># MyAnsible/inventories/my_virtual_machine</span></span>
<span class="line"><span class="token punctuation">[</span>my<span class="token punctuation">-</span>virtual<span class="token punctuation">-</span>machine<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">127.0.0.1 ansible_port=2222 ansible_user=YourBoxUser ansible_ssh_pass=YourSSHPassword</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The IP 127.0.0.1 as well as the port (2222) are default for this box. When you vagrant up you can check if the values are correct (you can also check by running vagrant ssh-config).</p><p>Don&#39;t forget to replace YourBoxUser and YourSSHPassword. For most vagrant boxes, it should both be &quot;vagrant&quot;. However, for the ubuntu/Xenial box and some others, the password is randomized for security reasons. You can check the username and password in your box default settings :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line"><span class="token function">cat</span> ~/.vagrant.d/boxes/ubuntu-VAGRANTSLASH-xenial64/20171011.0.0/virtualbox</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>20171011.0.0 is the date/version of the current box you&#39;re using. I&#39;m writing this mid-october 2017. On this box, YourBoxUser should be &quot;ubuntu&quot;.</p><p>Deploy your ansible to your virtual machine :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">ansible-playbook MyPlaybook.yml <span class="token parameter variable">-i</span> inventories/my_virtual_machine</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>If all goes well, your deployment should start. You might get the following error :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">fatal: <span class="token punctuation">[</span><span class="token number">127.0</span>.0.1<span class="token punctuation">]</span>: FAILED<span class="token operator">!</span> <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token string">&quot;failed&quot;</span><span class="token builtin class-name">:</span> true, <span class="token string">&quot;msg&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;Using a SSH password instead of a key is not possible because Host Key checking is enabled and sshpass does not support this. Please add this host&#39;s fingerprint to your known_hosts file to manage this host.&quot;</span><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>In that case, either manually connect with SSH first : ssh YourBoxUser@127.0.0.1 -p 2222 (you will be prompted for YourSSHPassword) You should be asked to validate a key fingerprint, accept it and you&#39;re done.</p><p>Another way to solve this error is creating in your ansible directory an ansible.cfg file with :</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token punctuation">[</span>defaults<span class="token punctuation">]</span></span>
<span class="line">host_key_checking = false</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>The error should be gone.</p><p>Another problem might be the absence of Python 2 on your box. If that happens, create a ANSIBLE playbook to install python without python being installed :</p><div class="language-yaml line-numbers-mode" data-highlighter="prismjs" data-ext="yml"><pre><code class="language-yaml"><span class="line"><span class="token comment"># python-dirty-install.yml</span></span>
<span class="line"><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all</span>
<span class="line">  <span class="token key atrule">gather_facts</span><span class="token punctuation">:</span> <span class="token boolean important">False</span></span>
<span class="line">  <span class="token key atrule">become</span><span class="token punctuation">:</span> <span class="token boolean important">True</span></span>
<span class="line"></span>
<span class="line">  <span class="token key atrule">tasks</span><span class="token punctuation">:</span></span>
<span class="line">    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> install python 2</span>
<span class="line">      <span class="token key atrule">raw</span><span class="token punctuation">:</span> test <span class="token punctuation">-</span>e /usr/bin/python <span class="token punctuation">|</span><span class="token punctuation">|</span> (apt <span class="token punctuation">-</span>y update <span class="token important">&amp;&amp;</span> apt install <span class="token punctuation">-</span>y python<span class="token punctuation">-</span>minimal)</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Run it with ansible-playbook python-dirty-install.yml -i inventories/my-virtual-machine. You should now be able to use your other playbook.</p><h2 id="step-5-running-your-rails-server" tabindex="-1"><a class="header-anchor" href="#step-5-running-your-rails-server"><span>Step 5 : Running your Rails server</span></a></h2><p>If you did your deployment script properly, you should have your app folder on your virtual machine. Go there and launch your rails server. You need to start puma on a different port (3001) and rails on port 3000 :</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh"><pre><code class="language-bash"><span class="line">bundle <span class="token builtin class-name">exec</span> puma <span class="token parameter variable">-C</span> config/puma.rb <span class="token parameter variable">-b</span> tcp://127.0.0.1:3001</span>
<span class="line"><span class="token function">sudo</span> rails server <span class="token parameter variable">-p</span> <span class="token number">3000</span> <span class="token parameter variable">-b</span> <span class="token number">0.0</span>.0.0</span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>Connect locally to <a href="http://localhost:3000/" target="_blank" rel="noopener noreferrer">http://localhost:3000/</a>. Congratulations, you are on Rails !</p><p>You can stop your vagrant virtual machine with vagrant halt if you want to keep it in its current state, or vagrant destroy to destroy it completely.</p></div><!--[--><!--]--></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="vp-meta-item last-updated"><span class="meta-item-label">Last Updated: </span><time class="meta-item-info" datetime="2025-10-31T06:20:24.000Z" data-allow-mismatch>10/31/25, 6:20 AM</time></div><div class="vp-meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: samuel.faure.dev@gmail.com">Samuelfaure</span><!----><!--]--><!--]--></span></div></div></footer><nav class="vp-page-nav" aria-label="page navigation"><a class="route-link auto-link prev" href="/tutorials/BuildYourOwnSystem.html" aria-label="📐 Build your own system with ArchLinux"><!--[--><div class="hint"><span class="arrow left"></span> Prev</div><div class="link"><span class="external-link">📐 Build your own system with ArchLinux</span></div><!--]--></a><a class="route-link auto-link next" href="/tutorials/UploadFilesFromVueToRails.html" aria-label="💎 Upload Files from Vue.js to Rails with ActiveStorage"><!--[--><div class="hint">Next <span class="arrow right"></span></div><div class="link"><span class="external-link">💎 Upload Files from Vue.js to Rails with ActiveStorage</span></div><!--]--></a></nav><!--[--><!--]--></main><!--]--></div><!--[--><!----><!--]--><!--]--></div>
    <script type="module" src="/assets/app-wnH-bxgu.js" defer></script>
  </body>
</html>
